<%include file="header.html"/>
<%include file="nav.html"/>
<%include file="animation.html"/>

<%!
  def space2url(text):
      return text.replace(' ', '%20')

  def removeVendors(text):
      return text.replace('Vendors/','')
%>  

<div class="section">

  <div class="field is-grouped has-addons">
    <div class="control is-expanded">
      <input class="input has-text-centered" type="text" id="searchInput" placeholder="jbl ..." autofocus />
    </div>
    <div class="control">
      <a class="button is-info">Search</a>
    </div>
  </div>

  <!-- Speakers -->
  % for speaker_name in meta:
  % if loop.index % 4 == 0:
  <div class="tile is-ancestor">
  % endif
    <div class="tile is-parent is-vertical is-3">
      <div class="tile is-child">
	<figure class="image is-3x4">
	  <img src="pictures/${speaker_name | space2url}.jpg" alt="Spinorama"/>
	</figure>
      </div>
      <div class="tile is-child">
	<div class="title is-6 is-pulled-left">${speaker_name}</div>
      </div>
      % if 'pref_rating' in meta[speaker_name]:
      <div class="subtile is-child">
	<div class="title is-6 is-pulled-right">${meta[speaker_name]['scaled_pref_rating']['scaled_pref_score']}/100</div>
      </div>
	% endif
      <div class="tile is-child">
	<div class="content is-small">
          % if 'pref_rating' in meta[speaker_name]:
  	  Bass extension: ${meta[speaker_name]['pref_rating']['lfx_hz']}Hz at -6dB
  	  <progress class="progress is-small is-info"
		    value="${meta[speaker_name]['scaled_pref_rating']['scaled_lfx_hz']}"
		    max="100"></progress>
	  Flatness: &plusmn;${meta[speaker_name]['estimates'][3]}dB ~ 80-20kHz
	  <progress class="progress is-small is-success"
		    value="${meta[speaker_name]['scaled_pref_rating']['scaled_flatness']}"
		    max="100"></progress>
	  Smoothness: ${meta[speaker_name]['pref_rating']['sm_sound_power']}
	  <progress class="progress is-small is-warning"
		    value="${meta[speaker_name]['scaled_pref_rating']['scaled_sm_sound_power']}"
		    max="100"></progress>
	  % else:
  	  % if 'estimates' in meta[speaker_name]:
	    ${meta[speaker_name]['estimates'][1]}Hz at -3dB<br/>
	    ${meta[speaker_name]['estimates'][2]}Hz at -6dB<br/>
	    &plusmn;${meta[speaker_name]['estimates'][3]}dB ~ 80-20kHz
	  % endif
	  % endif
	</div>
      </div>
      <div class="tile is-child">
	<div class="buttons has-addons is-centered are-small">
	  <button class="button is-white disable">Measurement</button>
	  % for m in meta[speaker_name]['measurements']:
	  <button class="button is-outlined">
	    <a href="${speaker_name}/${m['origin']}/index.html">${m['origin']}</a>
	  </button>
	  % endfor
	</div>
      </div>
    </div>

  % if loop.index % 4 == 3 or loop.index == len(meta)-1:
  </div>
  % endif
  % endfor
  
</div>


<%include file="footer.html"/>
